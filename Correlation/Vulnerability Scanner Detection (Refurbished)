source=Prod AND sourcetype=syslog AND process=httpd NOT OktaClass="*" NOT agentVersion="*" NOT OktaAdAgentId="*" AND OktaCrtrUserAgent="*" 
 | rex field=_raw "httpd\[(?<pro>.*)\]\: (?<sip>.*) - -"
 | eval SCANNER=case(match(OktaCrtrUserAgent, "/*WhiteHat Security*/"), "WhiteHat", 
                     match(OktaCrtrUserAgent, "/*Nikto\/*/") ,"Nikto", 
                     match(OktaCrtrUserAgent, "/*Nessus*/"),"Nessus", 
                     match(OktaCrtrUserAgent, "/*Havij*/"),"Havij", 
                     match(OktaCrtrUserAgent, "/*Sucuri Integrity*/"),"Sucuri Integrity Monitor", 
                     match(OktaCrtrUserAgent, "/*SiteLockSpider*/"),"SiteLockSpider", 
                     match(OktaCrtrUserAgent, "/*Burp*/"), "Burp", 
                     match(OktaCrtrUserAgent, "/*AppScan*/"), "AppScan")
 | where SANNER="*"
 | table SCANNER sip OktaCrtrUserAgent
 
 /* Original scanner user agents matches - courtsey Mattias Brutti */
